addons = {};def str.trimStart() (;while str[1] == " " and str != "" (;str = str.right(str.len - 1););return str;);def "addon_load" "data,id" (;adn_info = {};adn_scripts = {};adn_in_script = false;adn_current_script = [];adn_current_script_name = "";adn_catagory = "";each adn_line data.split(newline) (;adn_line = adn_line.trimStart();adn_tokens = adn_line.split(" ");adn_set = false;if adn_in_script.not (;if (adn_tokens.len == 2) and (adn_tokens[2].toStr() == "{") (;adn_catagory = adn_tokens[1];adn_set = true;);if adn_tokens.len == 1 and adn_tokens[1].toStr() == "}" (;adn_catagory = "";););if adn_set.not (;if adn_catagory == "scripts" (;if adn_tokens.len == 2 and adn_tokens[2].toStr() == "<" and adn_in_script.not (;adn_in_script = true;adn_current_script_name = adn_tokens[1];) else (;if adn_tokens.len == 1 and adn_tokens[1].toStr() == ">" and adn_in_script (;adn_in_script = false;adn_scripts[adn_current_script_name] = adn_current_script;adn_current_script = [];);if adn_in_script (;adn_current_script.append(adn_line););););if adn_catagory == "info" (;adn_key = adn_tokens[1];adn_tokens.shift();adn_info[adn_key] = adn_tokens.join(" "););););adn_addon = {};adn_addon["scripts"] = adn_scripts;adn_addon["info"] = adn_info;addons[id] = adn_addon;);def "addon_load_all" (;save "contents";save_list = save_data;each file save_list (;tokens = file.split(".");if tokens[2] == "adncfg" (;save file "get";addon_config[tokens[1]] = save_data.JsonParse();););addon_list = [];each file save_list (;tokens = file.split(".");if tokens[2] == "addon" (;addon_list.append(tokens[1]);if addon_config["disabled"].contains(tokens[1]).not (;save file "get";addon_load save_data tokens[1];addon_run tokens[1] "load";););););def "addon_init" (;icon_addon = "c #881bbf w 6 square 0 -2 5 6 square -2 3 3 5 dot 0 -3 w 3 c #6d1499 line 2 9.5 6.5 5 cont 2 5 cont 2 9.5 w 1.5 c #fff line -3.25 -1 -5.75 -4 cont -3.25 -7 line 3.25 -1 5.75 -4 cont 3.25 -7 line -2.5 -4 2.5 -4 line 0 -6.5 0 -1.5";icon_adncfg = "c #881bbf w 6 square 0 -2 5 6 square -2 3 3 5 dot 0 -3 w 3 c #6d1499 line 2 9.5 6.5 5 cont 2 5 cont 2 9.5 w 1.5 c #fff icn cog .55 0 -3.75";;file "install_type" "addon" icon_addon "Addon File" ["studio"];file "install_type" "adncfg" icon_adncfg "Addon Config" ["studio"];;addon_config = {};);def "addon_run" "addon,script" (;run addons[addon]["scripts"][script];);def "addon_event" "script" (;each addon_id addons.getKeys() (;addon_run addon_id script;);)
